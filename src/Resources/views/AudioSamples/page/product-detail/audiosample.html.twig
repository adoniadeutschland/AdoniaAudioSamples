{% sw_extends '@Storefront/storefront/utilities/offcanvas.html.twig' %}

{% block utilities_offcanvas_content %}
  {% if page.product.translated.customFields.custom_cd_enable %}
    <div class="btn-group-vertical col-6">
      <audio id="audioplayer" src="" controls>
        Your browser does not support the audio element.
      </audio>
    {% set audiosampleMediaIds = [] %}
    {% for key, id in page.product.translated.customFields %}
      {% if 'custom_cd_track' in key and 'name' not in key %}
        {% set audiosampleMediaIds = audiosampleMediaIds|merge([id]) %}
      {% endif %}
    {% endfor %}

    {% set mediaCollection =
      searchMedia(audiosampleMediaIds, context.context)
    %}
    {% for media in mediaCollection %}
      {% set audiosampleMedia = mediaCollection.get(media.id) %}
      <button class="btn btn-primary playlistButton" data-index="{{ loop.index0 }}"
        data-url="{{ audiosampleMedia.url }}">
        {{ audiosampleMedia.filename }}
      </button>
    {% endfor %}
    </div>
  {% endif %}

{% endblock %}
